<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>The Narayana Principle — Page‑Turn Test</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- jQuery + turn.js (classic build) -->
  <script src="https://code.jquery.com/jquery-3.7.1.js" 
    integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>  
  <script src="https://cdn.jsdelivr.net/gh/blasten/turn.js@master/turn.min.js"></script>

  <style>
    :root {
      --bg: #0b0d12;
      --paper: #0f1320;
      --ink: #dfe7ff;
      --accent: #c6a45b;
      --shadow: rgba(0,0,0,.35);
    }
    html, body {
      height: 100%;
      margin: 0;
      background: radial-gradient(1200px 600px at 50% -200px, #121725, var(--bg));
      color: var(--ink);
      font: 16px/1.6 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    }
    .wrap {
      display: grid;
      place-items: center;
      min-height: 100vh;
      padding: 2rem 1rem 4rem;
    }
    .chrome {
      display: flex;
      gap: .75rem;
      justify-content: center;
      align-items: center;
      margin-top: 1rem;
      opacity: .9;
    }
    button.ctrl {
      background: #111522;
      border: 1px solid #20263a;
      color: var(--ink);
      padding: .6rem .9rem;
      border-radius: .75rem;
      cursor: pointer;
      box-shadow: 0 4px 16px var(--shadow);
    }
    button.ctrl:active { transform: translateY(1px); }

    /* Book container */
    #book {
      box-shadow: 0 40px 80px var(--shadow);
      border-radius: 14px;
      overflow: hidden;
      background: #0d1120;
      /* so it recenters nicely */
      margin: 0 auto;
    }

    #bookBorder {
      border-right: 2pt solid gold;
      border-bottom: 2pt solid gold;
    }

    /* A 'page' */
    .page {
      width: 100%;
      height: 100%;
      padding: 2.2rem 2rem;
      box-sizing: border-box;
      background:
        radial-gradient(800px 500px at 30% 0%, #11162a 0%, #0e1324 50%, var(--paper) 100%);
      border-right: 1px solid rgba(255,255,255,.04);
    }

    .page h2 {
      margin: 0 0 .6rem;
      font-weight: 700;
      letter-spacing: .02em;
      color: var(--accent);
    }
    .page p { margin: 0 0 1rem; max-width: 60ch; }
    .page .art {
      height: 40%;
      margin: .5rem 0 1.2rem;
      border-radius: 12px;
      background:
        radial-gradient(120px 120px at 20% 30%, rgba(255,255,255,.08), transparent 60%),
        radial-gradient(240px 180px at 80% 70%, rgba(255,255,255,.06), transparent 60%),
        linear-gradient(135deg, #0b1d33, #15233b 60%, #0b1328);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.04), 0 20px 40px var(--shadow);
    }

    /* Reduce motion: disable the big curl */
    @media (prefers-reduced-motion: reduce) {
      .hint { display:none; }
    }

    .hint { text-align:center; opacity:.65; font-size:.9rem; margin-top:.5rem; }
  </style>
</head>
<body>
  <div class="wrap">
    <div id="bookBorder">
      <div id="book" aria-label="Prototype book with page turn effect"></div>
    </div>

    <div class="chrome" role="group" aria-label="Page controls">
      <button class="ctrl" id="prev" aria-label="Previous page">⟵ Prev</button>
      <span class="hint">Use ← → keys or click page corners</span>
      <button class="ctrl" id="next" aria-label="Next page">Next ⟶</button>
    </div>
  </div>

  <script>
    // ---- Utility: size the book responsively (keeps a 4:3 page spread ratio) ----
    function sizeBook() {
      const wrap = document.querySelector('.wrap');
      const vw = Math.min(1200, wrap.clientWidth - 16); // clamp width
      const vh = Math.min(800, window.innerHeight - 180); // leave room for controls
      // Single page aspect ~ 3:4; a spread is two pages → 6:4
      let width = Math.min(vw, Math.floor(vh * (6/4)));
      let height = Math.floor(width * (4/6));
      // Minimums for small phones
      width = Math.max(320, width);
      height = Math.max(220, height);
      $('#book').width(width).height(height);
      $('#bookBorder').width(width + 10).height(height + 10);
      if ($('#book').data('initialized')) {
        $('#book').turn('size', width, height);
      }
    }

    // ---- Build pages (you can replace this with real HTML/MD later) ----
    const pages = [
      { title: "Cover", content: "<p><em>The Narayana Principle</em></p><p>Tap to open the book.</p>" },
      { title: "Prologue", content: "<div class='art'></div><p>Before the first spark, there was an appetite for pattern…</p>" },
      { title: "Chapter I — Seed", content: "<div class='art'></div><p>A grain of symmetry falls into time, and calls itself possible.</p>" },
      { title: "Interlude — Entropy", content: "<p>Order is a local rumor the cosmos keeps forgetting.</p>" },
      { title: "Chapter II — Waters", content: "<div class='art'></div><p>Where gradients gather, stories learn to flow.</p>" },
      { title: "Chapter III — Tongues", content: "<div class='art'></div><p>Signals braid into memory, and memory rehearses intent.</p>" }
    ];

    function pageHTML(p) {
      return `<div class="page">
                <h2>${p.title}</h2>
                ${p.content}
              </div>`;
    }

    // ---- Init turn.js ----
    function initBook() {
      // populate pages
      const $book = $('#book');
      $book.html(pages.map(pageHTML).join(''));
      console.log($book.html);

      // prefer reduced motion? shorten duration
      const reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      $book.turn({
        gradients: true,
        acceleration: true,
        autoCenter: true,
        display: 'single', // double or single, two pages like a spread
        duration: reduce ? 150 : 700,
        elevation: 50
      });

      $book.data('initialized', true);

      // Keyboard controls
      $(document).on('keydown', (e) => {
        if (e.key === 'ArrowRight') $book.turn('next');
        if (e.key === 'ArrowLeft')  $book.turn('previous');
      });

      // Buttons
      $('#next').on('click', () => $book.turn('next'));
      $('#prev').on('click', () => $book.turn('previous'));

      // Basic analytics hook (logs to console for now)
      $book.bind('turned', (e, page, view) => {
        console.log('Turned to page', page, 'view:', view);
      });
    }

    // ---- Setup & resize handling ----
    window.addEventListener('resize', () => {
      clearTimeout(window._rsz);
      window._rsz = setTimeout(sizeBook, 80);
    });

    // First paint
    sizeBook();
    initBook();
    sizeBook(); // ensure correct size after init
  </script>
</body>
</html>
